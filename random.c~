#include <stdint.h>
#include "random.h"


uint16_t lfsr = PRAND_START;

uint8_t prand() {
    uint8_t bit0,bit2,bit3,bit5,bit16,res,i;

    /*save result*/
    res = lfsr;

    /*shift lfsr for 8 bit*/
    for(i=0;i<8;i++) {
        bit0 = lfsr & 0b00000001;
        bit2 = (lfsr & 0b00000100) >> 2;
        bit3 = (lfsr & 0b00001000) >> 3;
        bit5 = (lfsr & 0b00010000) >> 5;
        bit16 = ((bit0 ^ bit2) ^ bit3) ^ bit5;
        lfsr >>= 1;
        /*if bit16 should be set, set it in lfsr*/
        if(bit16)
            lfsr |= 0x8000;
    }
    return res;
}
